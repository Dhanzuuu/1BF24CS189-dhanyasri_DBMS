show databases;
create database if not exists supplierdatabases;
show databases;
use supplierdatabases;
create table supplier(sid int primary key,sname varchar(40),city varchar(40));
create table parts(pid int primary key,pname varchar(40),colour varchar(40));
create table catalog(sid int ,pid int,cost int,primary key(sid,pid),foreign key(sid)references supplier(sid),foreign key(pid) references parts(pid));
insert into supplier values(1, 'Acme Widget Suppliers', 'New York'),(2, 'Global Parts Co', 'London'),(3, 'Universal Traders', 'Paris');
select *from supplier;
insert into parts values(101, 'Bolt', 'Red'),(102, 'Nut', 'Green'),(103, 'Screw', 'Red'),(104, 'Washer', 'Blue');
select *from parts;
insert into catalog values(1, 101, 10),(1, 102, 15),(2, 101, 12),(2, 103, 14),(3, 101, 11),(3, 102, 13),(3, 104, 18);
select *from catalog;
select distinct p.pname from parts p join catalog c on p.pid=c.pid;
select s.sname from supplier s where not exists(select p.pid from parts p where not exists(select c.pid from catalog c where c.sid=s.sid and c.pid=p.pid));
select s.sname from supplier s where not exists(select p.pid from parts p where p.colour='red' and not exists(select c.pid from catalog c where c.sid=s.sid and c.pid=p.pid));
select distinct c1.sid from catalog c1 where c1.cost>(select avg(c2.cost) from catalog c2 where c2.pid=c1.pid);
select p.pname,s.sname from parts p join catalog c on p.pid=c.pid join supplier s on c.sid=s.sid where c.cost = (select max(c2.cost) from catalog c2 where c2.pid=p.pid);
select p.pname from parts p join catalog c1 on p.pid=c1.pid join supplier s1 on c1.sid=s1.sid where s1.sname='Acme Widget Suppliers' and p.pid not in(select c2.pid from catalog c2 join supplier s2 on c2.sid=s2.sid where s2.sname <>'Acme Widget Suppliers');